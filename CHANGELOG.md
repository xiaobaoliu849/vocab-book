# 更新日志 (Changelog)

## v3.3 (Current)
- **健壮性优化**: 修复了由于有道词典连接超时/SSL错误导致的 `KeyError: 'date'` 崩溃问题；增强了数据库添加单词时的字段校验，支持所有字段缺省值。
- **Bug 修复**:
  - 修复 `DetailWindow` 中重复定义的 `delete_word` 方法导致删除功能失效的问题
  - 修复 `ReviewView` 复习队列的线程竞态问题，添加队列操作锁保护
  - 修复 `ReviewView` 事件处理器重复绑定导致的内存泄漏
  - 修复 `ReviewView` 中 6 个方法重复定义导致的代码冗余
  - 修复 `AddView` 重复搜索导致的并发写入问题，添加搜索锁
  - 修复 `AudioService` 文件删除时静默捕获所有异常的问题
  - 修复 `UpdateService` 版本比较时静默捕获异常的问题
  - 修复 `ListView` 和 `ReviewView` 中可能出现的 KeyError 空值访问问题
  - 修复 `ListView` 空列表提示中使用不存在的 `word_btn` 键导致的崩溃
  - 修复 `ReviewScheduler` 后台线程访问数据库的竞态条件
  - 修复 `main.py` 中 `reload_vocab_list()` 和 `quit_app()` 缺少异常保护的问题
  - 修复 `database.py` 中 11 个方法的数据库连接泄漏问题
- **搜索降级机制**: 完善了多词典查询的降级逻辑，当主要词典源（有道）不可用时，自动无缝切换至剑桥、Bing等备用源。
- **设置界面重构**: 采用侧边栏导航布局 (Sidebar Layout)，将设置项分类为统计、常规、词典、关于，优化视觉体验。
- **自动更新机制**: 实现基于 Bat 脚本替换的自更新流程 (Auto Update)，支持版本检测、自动下载、无缝替换重启。

## v3.2
- **派生词群组**: 内置40+常见词根库，自动识别词根并在详情页展示派生词群组，区分"已在词库"和"推荐添加"，支持一键跳转添加。
- **系统托盘**: 支持最小化到系统托盘，托盘菜单支持显示/复习/退出。
- **复习提醒**: 后台定时检查待复习单词并弹出 Windows 系统通知，可配置提醒间隔（15分钟~2小时或关闭）。
- **智能关闭**: 关闭窗口时弹出选择对话框（最小化到托盘/直接退出），支持"记住我的选择"，可在设置中随时修改。
- **系统行为设置**: 设置页面新增"系统行为"卡片，可配置关闭行为和复习提醒间隔。
- **多词典聚合**: 详情页支持 Bing 词典和 Free Dictionary API，分区块展示多词典释义，可在设置中开关各词典源。

## v3.1
- **架构改进**: 彻底完成代码拆分，实现模块化 (views/models/services)。
- **复习算法**: 实现了完整的 SuperMemo SM-2 算法。
- **学习热力图**: 在设置页面展示过去一年的复习热度。
- **单词详情**: 实现了独立的详情弹窗，支持内容复制和快捷查词。
- **批量删除**: 列表页支持多选批量删除单词。
- **导入导出**: 支持 CSV 格式的导入和导出。
- **自动化解析**: 自动解析并存储单词的词根、词缀及同近义词。
- **全局快捷键**: 实现了 `Ctrl+N/L/R/S` 快速切换页面。
- **主题适配**: 修复了深色模式下 Canvas 背景色不跟随主题的问题。
- **统一配置**: 使用 `config.json` 统一管理主题、快捷键等配置。
- **语境填空**: 实现了闪卡和拼写模式下的语境填空 (Cloze Deletion)。
